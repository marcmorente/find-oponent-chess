function upload(){const e="/src/ajaxrequest/upload_pgn.php",a=["application/x-chess-pgn","application/da-chess-pgn","application/vnd.chess-pgn","text/plain"];Swal.fire({title:"Selecciona un arxiu",showCancelButton:!0,confirmButtonText:"Importar!",cancelButtonText:"Cancel·lar",showLoaderOnConfirm:!0,input:"file",willOpen:()=>{const e=document.querySelector(".swal2-file");e.addEventListener("change",(function(){const e=new FileReader;e.readAsDataURL(this.files[0])}))},preConfirm:n=>{const t=n;if(null===t||!checkFile(a,t))return;const r=new FormData;r.append("fileToUpload",t);const o=new Request(e,{method:"POST",body:r});return fetch(o).then(e=>e.json()).catch(e=>{Swal.showValidationMessage(`Request failed: ${e}`)})},allowOutsideClick:()=>!Swal.isLoading()}).then(e=>{null!==e.value?e.isConfirmed&&Swal.fire(e.value.error?"Error":"Importatació correcta!",e.value.error?e.value.message:"Ja pots buscar les partides al sistema.",e.value.error?"error":"success"):Swal.fire("Atenció!","Has de seleccionar un arxiu.","warning")})}function checkFile(e,a){const n=bytesToSize(a.size);return e.includes(a.type)?!(a.size>2e7)||(Swal.fire("Atenció!",`L'arxiu és massa gran(${n}), màxim 20MB.`,"warning"),!1):(Swal.fire("Error",`${a.name} no és un arxiu vàlid.`,"error"),!1)}function bytesToSize(e){var a=["Bytes","KB","MB","GB","TB"];if(0==e)return"0 Byte";var n=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,n),2)+" "+a[n]}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#upload");e.addEventListener("click",e=>{e.preventDefault(),upload()})});