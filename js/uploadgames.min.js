function upload(){const e="/src/ajaxrequest/upload_pgn.php",n=["application/x-chess-pgn","application/da-chess-pgn","application/vnd.chess-pgn","text/plain"];Swal.fire({title:"Selecciona un arxiu",showCancelButton:!0,confirmButtonText:"Importar!",showLoaderOnConfirm:!0,input:"file",willOpen:()=>{const e=document.querySelector(".swal2-file");e.addEventListener("change",(function(){const e=new FileReader;e.readAsDataURL(this.files[0])}))},preConfirm:t=>{const a=t;if(null===a||!checkFile(n,a))return;const r=new FormData;r.append("fileToUpload",a);const o=new Request(e,{method:"POST",body:r});return fetch(o).then(e=>e.json()).catch(e=>{Swal.showValidationMessage(`Request failed: ${e}`)})},allowOutsideClick:()=>!Swal.isLoading()}).then(e=>{null!==e.value?e.isConfirmed&&Swal.fire(e.error?"Error":"Importatació correcta!",e.error?e.message:"Ja pots buscar les partides al sistema.",e.error?"error":"success"):Swal.fire("Atenció!","Has de seleccionar un arxiu.","warning")})}function checkFile(e,n){const t=bytesToSize(n.size);return e.includes(n.type)?!(n.size>5e7)||(Swal.fire("Atenció!",`L'arxiu és massa gran(${t}), màxim 50MB.`,"warning"),!1):(Swal.fire("Error",`${n.name} no és un arxiu vàlid.`,"error"),!1)}function bytesToSize(e){var n=["Bytes","KB","MB","GB","TB"];if(0==e)return"0 Byte";var t=parseInt(Math.floor(Math.log(e)/Math.log(1024)));return Math.round(e/Math.pow(1024,t),2)+" "+n[t]}document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("#upload");e.addEventListener("click",e=>{e.preventDefault(),upload()})});